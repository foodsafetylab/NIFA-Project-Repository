#plotting alpha diversity
alphaplot_pre_rare_type<- plot_richness(phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Shannon") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Simpson
Simp_alphaplot_pre_rare_type<- plot_richness(phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp_alphaplot_pre_rare_type
alphaplot_pre_rare_type
phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
phyloPreharvest_rare<-rarefy_even_depth(phyloPreharvest_rare, sample.size = 63, rngseed = 19)
View(phyloPreharvest_rare)
View(phyloPreharvest)
phyloPreharvest@sam_data$Total.reads
phyloPreharvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Preharvest")
phyloPreharvest@sam_data$Total.reads
sort(sample_sums(phyloPreharvest))
hist(log10(sample_sums(phyloPreharvest)), main="Histogram: Read Counts", xlab="Total Reads",
border="blue", col="green", las=1, breaks=6)
sort(sample_sums(phyloseqAll))# - check if you must
##subset phyloseq object to only show preharvest, no removal of mitochondria or cloroplasts
Initial_phyloPreharvest<- subset_samples(phyloseqAll_test, Sample.Time.Point=="Preharvest")
View(Initial_phyloPreharvest)
View(phyloseqAll)
#check reads remaining in preharvest
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts", xlab="Log10 Total Reads",
border="blue", col="green", las=1, breaks=15)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts", xlab="Log10 Total Reads",
border="blue", col="green", las=1, breaks=6)
#check reads remaining in preharvest
Initial_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts", xlab="Log10 Total Reads",
border="blue", col="green", las=1, breaks=15)
sort(sample_sums(phyloPreharvest))
hist(log10(sample_sums(phyloPreharvest)), main="Histogram: Read Counts", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
View(phyloPreharvest)
twoK_prune_phylopreharvest<-prune_samples(sample_sums(phyloPreharvest)>=2000, phyloPreharvest)
View(twoK_prune_phylopreharvest)
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
##subset phyloseq object to only show preharvest, no removal of mitochondria or cloroplasts
Initial_phyloPreharvest<- subset_samples(phyloseqAll_test, Sample.Time.Point=="Preharvest")
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
#check reads remaining in preharvest - for meeting purposes
Cloro_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
hist(log10(sample_sums(phyloPreharvest)), main="Histogram: Read Counts", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
Initial_Rare<-rarefy_even_depth(Cloro_phyloPreharvest, sample.size = min(sample_sums(Cloro_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
#check reads remaining in preharvest - for meeting purposes
NoCloro_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
initial_alpha<-estimate_richness(Initial_Rare, measures = "Simpson")
#Rarefaction plot - preharvest w/cloroplasts
initial_Simp_alphaplot_pre_rare_type<- plot_richness(Initial_Rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
initial_Simp_alphaplot_pre_rare_type
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(phyloPreharvest_rare, sample.size = 63, rngseed = 19)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(phyloPreharvest_rare, sample.size = 125, rngseed = 19)
one25phyloPreharvest_rare<-rarefy_even_depth(phyloPreharvest_rare, sample.size = 125, rngseed = 19)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp63_alphaplot_pre_rare_type
Simp125_alphaplot_pre_rare_type
Simp250_alphaplot_pre_rare_type
View(alpha_pre_rare)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
View(meta_file)
View(metadata_1_)
str(metadata_1_)
str(meta_file)
meta_file$Sample.Type<-as.factor(meta_file$Sample.Type)
meta_file
meta_file$Sample.Type<-replace(meta_file$Sample.Type,meta_file$Sample.Type=="Produce High Resolution","Produce")
sample_meta_data<- sample_data(meta_file)
phyloseqAll_test<- phyloseq(ASV_table, sample_meta_data, taxa_table)
##subset phyloseq object to only show preharvest, no removal of mitochondria or cloroplasts
Initial_phyloPreharvest<- subset_samples(phyloseqAll_test, Sample.Time.Point=="Preharvest")
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
phyloseqAll<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
#check reads remaining
Reads_rem_phyloseqAll<-sample_sums(phyloseqAll)
#sort(sample_sums(phyloseqAll))# - check if you must
hist(log10(sample_sums(phyloseqAll)), main="Histogram: Preharvest samples Read Counts", xlab="Log10 Total Reads",
border="blue", col="green", las=1, breaks=15)
meta_File_4test$filtered.reads<-sample_sums(phyloseqAll)
#meta_File_4test$filtered.reads<-sample_sums(phyloseqAll)
#check reads remaining in preharvest - for meeting purposes
NoCloro_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Read Counts", xlab="Log scale Total Reads",
border="blue", col="green", las=1, breaks=15)
phyloPreharvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Preharvest")
sort(sample_sums(phyloPreharvest))
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples Read Counts", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
twoK_prune_phylopreharvest<-prune_samples(sample_sums(phyloPreharvest)>=2000, phyloPreharvest)
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
initial_alpha<-estimate_richness(Initial_Rare, measures = "Simpson")
#Rarefaction plot - preharvest w/cloroplasts
initial_Simp_alphaplot_pre_rare_type<- plot_richness(Initial_Rare, x="Sample.Type", color="Sample.Type", title = "Initial Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
initial_Simp_alphaplot_pre_rare_type
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
r250_alpha_pre_rare
Simp250_alphaplot_pre_rare_type
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp250_alphaplot_pre_rare_type
View(two50phyloPreharvest_rare)
View[two50phyloPreharvest_rare@sam_data$Sample.Type]
[two50phyloPreharvest_rare@sam_data$Sample.Type]
two50phyloPreharvest_rare@sam_data$Sample.Type
phyloPreharvest_rare<- subset_samples(phyloseqAll_rare, Sample.Time.Point=="Preharvest")
phyloPreharvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Preharvest")
phyloHarvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Harvest")
phyloPostHarvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Post Harvest")
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
Simp250_alphaplot_pre_rare_type
View(meta_file)
Simp250_alphaplot_pre_rare_type
View(phyloPreharvest)
View(phyloseqAll)
phyloseqAll@sam_data$Sample.Type
phyloseqAll<-phyloseq(ASV_table, sample_meta_data, taxa_table)
phyloseqAll<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
#check reads remaining
Reads_rem_phyloseqAll<-sample_sums(phyloseqAll)
#sort(sample_sums(phyloseqAll))# - check if you must
hist(log10(sample_sums(phyloseqAll)), main="Histogram: Preharvest samples Read Counts", xlab="Log10 Total Reads",
border="blue", col="green", las=1, breaks=15)
#meta_File_4test$filtered.reads<-sample_sums(phyloseqAll)
#check reads remaining in preharvest - for meeting purposes
NoCloro_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Read Counts", xlab="Log scale Total Reads",
border="blue", col="green", las=1, breaks=15)
phyloPreharvest<- subset_samples(phyloseqAll, Sample.Time.Point=="Preharvest")
sort(sample_sums(phyloPreharvest))
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples Read Counts", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
twoK_prune_phylopreharvest<-prune_samples(sample_sums(phyloPreharvest)>=2000, phyloPreharvest)
oneK_prune_phylopreharvest<-prune_samples(sample_sums(phyloPreharvest)>=1000, phyloPreharvest)
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
initial_alpha<-estimate_richness(Initial_Rare, measures = "Simpson")
#Rarefaction plot - preharvest w/cloroplasts
initial_Simp_alphaplot_pre_rare_type<- plot_richness(Initial_Rare, x="Sample.Type", color="Sample.Type", title = "Initial Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
Simp250_alphaplot_pre_rare_type
View(two50phyloPreharvest_rare)
no.na = !is.na(tax_table(two50phyloPreharvest_rare)[,"Genus"]) & !is.na(tax_table(two50phyloPreharvest_rare)[,"Species"])
tax_table(two50phyloPreharvest_rare)[no.na][,"Species"] = paste(tax_table(two50phyloPreharvest_rare)[no.na][,"Genus"], tax_table(two50phyloPreharvest_rare)[no.na][,"Species"])
#For obvious reasons, Kingdom and Domain is not here
two50tax.glom.phylum.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Phylum")
two50tax.glom.class.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Class")
two50tax.glom.order.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Order")
two50tax.glom.family.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Family")
two50tax.glom.genus.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Genus")
two50tax.glom.species.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Species")
#Getting top 10 taxa for each agglomerated taxomic ranking from the same phyloseq Preharvest object
two50top10phylum_PrHrarefied<-top_taxa(two50tax.glom.phylum.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Phylum")
#For obvious reasons, Kingdom and Domain is not here
two50tax.glom.phylum.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Phylum")
two50tax.glom.class.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Class")
two50tax.glom.order.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Order")
two50tax.glom.family.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Family")
two50tax.glom.genus.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Genus")
two50tax.glom.species.rarefied.PrH<- tax_glom(two50phyloPreharvest_rare, taxrank="Species")
two50plot0test<- plot_bar(two50top10class_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Phylum", title="Most Abundant Phylas") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
#Getting top 10 taxa for each agglomerated taxomic ranking from the same phyloseq Preharvest object
two50top10phylum_PrHrarefied<-top_taxa(two50tax.glom.phylum.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Phylum")
detach(microbiomeMarker)
detach(microbiome)
detach("microbiome")
library(dada2)
library(ggplot2)
library(tidyverse)
library(devtools)
library(fantaxtic)
#library(devtools)
#library(fantaxtic)
#library(MicEco)
library(microbiome)
library(phyloseq)
library(vegan)
library(ggpubr)
library(rstatix)
library(RVAideMemoire)
library(eulerr)
library(microbiomeMarker)
#Getting top 10 taxa for each agglomerated taxomic ranking from the same phyloseq Preharvest object
two50top10phylum_PrHrarefied<-top_taxa(two50tax.glom.phylum.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Phylum")
detach("microbiome")
detach("package:microbiome", unload = TRUE)
#Getting top 10 taxa for each agglomerated taxomic ranking from the same phyloseq Preharvest object
two50top10phylum_PrHrarefied<-top_taxa(two50tax.glom.phylum.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Phylum")
two50top10class_PrHrarefied<-top_taxa(two50tax.glom.class.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Class")
two50top10order_PrHrarefied<-top_taxa(two50tax.glom.order.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Order")
two50top10family_PrHrarefied<-top_taxa(two50tax.glom.family.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Family")
two50top10genus_PrHrarefied<-top_taxa(two50tax.glom.genus.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Genus")
two50top10species_PrHrarefied<-top_taxa(two50tax.glom.species.rarefied.PrH, n_taxa = 10, grouping="Sample.Type", tax_level = "Species")
two50plot0test<- plot_bar(two50top10class_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Phylum", title="Most Abundant Phylas") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
plot1test<- plot_bar(top10genus_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Genus", title="Most Abundant Genus") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot0test<- plot_bar(two50top10class_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Phylum", title="Most Abundant Phylas") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot1test<- plot_bar(two50top10genus_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Genus", title="Most Abundant Genus") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot2test<- plot_bar(two50top10family_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Family", title="Most Abundant Families") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot3test<- plot_bar(two50top10species_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Species", title="Most Abundant Species") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot4test<- plot_bar(two50top10order_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Order", title="Most Abundant Orders") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot5test<- plot_bar(two50top10class_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Class", title="Most Abundant Classes") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot5test
two50plot3test
#Plot
PCoA_pre_rare<- ordinate(two50phyloPreharvest_rare, method="PCoA", distance="bray")
#plot of PCoA - using the rarafied to 550 reads of preharvest samples
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare") + stat_ellipse()+
geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare") + stat_ellipse()+
geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
save.image("C:/Users/jorge/Box Sync/NIFA Project/NIFA Project Repository/Phyloseq analysis2021.RData")
library(dada2)
library(ggplot2)
library(tidyverse)
library(devtools)
library(fantaxtic)
#library(devtools)
#library(fantaxtic)
#library(MicEco)
library(microbiome)
library(phyloseq)
library(vegan)
library(ggpubr)
library(rstatix)
library(RVAideMemoire)
library(eulerr)
library(microbiomeMarker)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Histogram: Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="blue", col="green", las=1, breaks=6)
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Number of Reads", xlab="Log scale Total Reads",
border="blue", col="green", las=1, breaks=15)
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Number of Reads", xlab="Log scale Total Reads",
border="blue", col="darkseagreen", las=1, breaks=15)
s
#meta_File_4test$filtered.reads<-sample_sums(phyloseqAll)
#check reads remaining in preharvest - for meeting purposes
NoCloro_phyloPreharvest<-phyloseqAll%>%
subset_taxa(Family!="Mitochondria"|is.na(Family) & Order !="Chloroplast"|is.na(Order))
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Number of Reads", xlab="Log scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=15)
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples Read Counts", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=6)
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
initial_alpha<-estimate_richness(Initial_Rare, measures = "Simpson")
#Rarefaction plot - preharvest w/cloroplasts
initial_Simp_alphaplot_pre_rare_type<- plot_richness(Initial_Rare, x="Sample.Type", color="Sample.Type", title = "Initial Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
initial_Simp_alphaplot_pre_rare_type
boxplot(Value~Simpson, data=drSgathertest, xlab = "Sequences per samples", ylab="Simpson Diversity Index", las=1)
#getting alpha diversity
alpha_2k32prune<- estimate_richness(phyloPrH_2KPrune32_rare, measures = "Simpson")
alpha_2k63prune<- estimate_richness(phyloPrH_2KPrune63_rare, measures = "Simpson")
alpha_2k125prune<- estimate_richness(phyloPrH_2KPrune125_rare, measures = "Simpson")
alpha_2k250prune<- estimate_richness(phyloPrH_2KPrune250_rare, measures = "Simpson")
alpha_2k500prune<- estimate_richness(phyloPrH_2KPrune500_rare, measures = "Simpson")
alpha_2k1000prune<- estimate_richness(phyloPrH_2KPrune1000_rare, measures = "Simpson")
alpha_2k1500prune<- estimate_richness(phyloPrH_2KPrune1500_rare, measures = "Simpson")
drSTestRunSimpson<-cbind.data.frame(alpha_2k32prune, alpha_2k63prune, alpha_2k125prune, alpha_2k250prune, alpha_2k500prune, alpha_2k1000prune, alpha_2k1500prune)
colnames(drSTestRunSimpson)<-c("32", "63", "125", "250", "500", "1000", "1500")
drSgathertest<- gather(drSTestRunSimpson, Simpson, Value, "32":"1500")
drSgathertest$Simpson<-factor(drSgathertest$Simpson, levels=c("32", "63", "125", "250", "500", "1000", "1500"))
boxplot(Value~Simpson, data=drSgathertest, xlab = "Sequences per samples", ylab="Simpson Diversity Index", las=1)
#teting for diferences in diversity by reducing number of reads/sample
myaov<-aov(Value~Simpson, data=drSgathertest)%>%tukey_hsd()
View(myaov)
six3phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=63, phyloPreharvest)
six3phyloPreharvest_rare<-rarefy_even_depth(six3phyloPreharvest_rare, sample.size = 63, rngseed = 19)
one25phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=125, phyloPreharvest)
one25phyloPreharvest_rare<-rarefy_even_depth(one25phyloPreharvest_rare, sample.size = 125, rngseed = 19)
two50phyloPreharvest_rare<-prune_samples(sample_sums(phyloPreharvest)>=250, phyloPreharvest)
two50phyloPreharvest_rare<-rarefy_even_depth(two50phyloPreharvest_rare, sample.size = 250, rngseed = 19)
Simp63_alphaplot_pre_rare_type<- plot_richness(six3phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp125_alphaplot_pre_rare_type<- plot_richness(one25phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
Simp250_alphaplot_pre_rare_type<- plot_richness(two50phyloPreharvest_rare, x="Sample.Type", color="Sample.Type", title = "Alpha Diversity of Sample Types (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
#Calculated richness for preharvest samples rarefied at 63, 125 and 250 reads
r63_alpha_pre_rare<-estimate_richness(six3phyloPreharvest_rare)
r125_alpha_pre_rare<-estimate_richness(one25phyloPreharvest_rare)
r250_alpha_pre_rare<-estimate_richness(two50phyloPreharvest_rare)
r250_alpha_pre_rare
View(r250_alpha_pre_rare)
Simp250_alphaplot_pre_rare_type
Initial_Rare<-rarefy_even_depth(Initial_phyloPreharvest, sample.size = min(sample_sums(Initial_phyloPreharvest)),
rngseed =23, replace = TRUE, trimOTUs = TRUE, verbose = TRUE)
initial_alpha<-estimate_richness(Initial_Rare, measures = "Simpson")
#Rarefaction plot - preharvest w/cloroplasts
initial_Simp_alphaplot_pre_rare_type<- plot_richness(Initial_Rare, x="Sample.Type", color="Sample.Type", title = "Initial Alpha Diversity of Sample Types including cloroplasts and non-bacterial reads (rare, preharvest)", measures="Simpson") + geom_boxplot() + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15)) +
xlab("Sample Type") + labs(color= "Sample Type") + geom_point(alpha = 0.75)
View(initial_Simp_alphaplot_pre_rare_type)
initial_Simp_alphaplot_pre_rare_type
Simp250_alphaplot_pre_rare_type
#plot of PCoA - using the rarafied to 550 reads of preharvest samples
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare") + stat_ellipse()+
geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare") + stat_ellipse()+
geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
two50plot3test<- plot_bar(two50top10species_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Species", title="Most Abundant Species") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot3test
#plot of PCoA - using the rarafied to 550 reads of preharvest samples
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+
geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+
+   geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
+   labs(shape="Field Location") + labs(color= "Sample Type")
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+
+   geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
+   labs(shape="Field Location") + labs(color= "Sample Type")
#plot of PCoA - using the rarafied to 550 reads of preharvest samples
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+ geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+ geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
two50plot3test
save.image("C:/Users/jorge/Box Sync/NIFA Project/NIFA Project Repository/Phyloseq analysis2021.RData")
boxplot(Value~Simpson, data=drSgathertest, xlab = "Sequences per samples", ylab="Simpson Diversity Index", las=1)
boxplot(Value~Simpson, data=drSgathertest, xlab = "Sequences per samples", ylab="Simpson Diversity Index", las=1)+title("Multiple Rarefactions at Increasing Sequencing Depth")
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples - Reads after trimming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=6)
hist(log10(sample_sums(NoCloro_phyloPreharvest)), main="Preharvest samples Number of Reads", xlab="Log scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=15)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=6)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=10)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=10)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=15)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=20)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=30)
Simp250_alphaplot_pre_rare_type
plot3k<-geom_boxplot(drSTestRunSimpson, aes(Value, Simpson))
plot3k<-geom_boxplot(drSTestRunSimpson, mapping=aes(Value, Simpson))
plot3k
plot3k
plot3k<-ggplot()+geom_boxplot(drSTestRunSimpson, mapping=aes(Value, Simpson))
plot3k
View(drSTestRunSimpson)
plot3k<-ggplot()+geom_boxplot(drSTestRunSimpson, mapping=aes())
plot3k
Simp250_alphaplot_pre_rare_type
Simp250_alphaplot_pre_rare_type
plot_ordination(two50phyloPreharvest_rare, PCoA_pre_rare, color = "Sample.Type", title="Bray-Curtis PCoA of preharvest samples, rare", label = "Sample.name") + stat_ellipse()+ geom_point(aes(), size=3) + theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15)) +
labs(shape="Field Location") + labs(color= "Sample Type")
two50plot0test<- plot_bar(two50top10class_PrHrarefied[["ps_obj"]], x="Sample.name", fill="Phylum", title="Most Abundant Phylas") + facet_wrap(~Sample.Type, scales="free_x") + #+ scale_fill_manual(values = c("orchid3", "tomato3", "rosybrown1", "gold", "grey", "mediumturquoise", "lightcoral")) +
theme(axis.text.x = element_text(size = 12), axis.text.y = element_text(size=12), axis.title = element_text(size=15), title=element_text(size=18), legend.text = element_text(size=15), strip.text=element_text(size=15))
two50plot0test
two50plot1test
two50plot2test
two50plot3test
two50plot4test
two50plot5test
save.image("C:/Users/jorge/Box Sync/NIFA Project/NIFA Project Repository/Phyloseq analysis2021.RData")
knitr::opts_chunk$set(echo = TRUE)
set.seed(23)
#Based on simpson index - The higher the index, the higher bacteria diversity within the sample
two50alpha_pre_modelSimp_rare<-aov(Simpson~Sample.Type, data=two50phyloPreharvest_rare)
library(dada2)
library(ggplot2)
library(tidyverse)
library(devtools)
library(fantaxtic)
#library(devtools)
#library(fantaxtic)
#library(MicEco)
library(microbiome)
library(phyloseq)
library(vegan)
library(ggpubr)
library(rstatix)
library(RVAideMemoire)
library(eulerr)
library(microbiomeMarker)
#Based on simpson index - The higher the index, the higher bacteria diversity within the sample
two50alpha_pre_modelSimp_rare<-aov(Simpson~Sample.Type, data=two50phyloPreharvest_rare)
metadata_2_<- sample_data(two50phyloPreharvest_rare)
two50alpha_pre_rare$Sample.Type<- metadata_2_$Sample.Type
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples - Reads after trimming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=30)
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples - Reads after trimming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=30)
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples - Reads after trimming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=15)
hist(log10(sample_sums(phyloPreharvest)), main="Preharvest samples - Reads after trimming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=10)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=10)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=12)
hist(log10(sample_sums(Initial_phyloPreharvest)), main="Preharvest samples Read Counts before triming", xlab="Log Scale Total Reads",
border="black", col="darkseagreen", las=1, breaks=5)
